{"version":3,"sources":["webpack:///src/components/comment/CommentAction.vue","webpack:///./src/components/comment/CommentAction.vue?0ca8","webpack:///./src/components/comment/CommentAction.vue","webpack:///src/components/comment/CommentList.vue","webpack:///./src/components/comment/CommentList.vue?021e","webpack:///./src/components/comment/CommentList.vue"],"names":["CommentAction","name","props","inject","data","f","cv","post_id","this","$route","params","id","cuser","$store","state","userinfo","username","newaddc","computed","ifcandel","i","author","item","methods","reply","canc","postcommentdata","_this","Object","api","content","post","reply_to","parent_comment","then","res","console","log","$Message","success","$emit","catch","err","ret_to","error","setTimeout","reload","tolog","deletec","_this2","t","confirm","pid","parseInt","_this3","$router","push","query","backurl","comment_CommentAction","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","xs","sm","md","_v","_s","create_time","_e","type","ghost","size","on","click","autosize","maxlength","clearable","placeholder","model","value","callback","$$v","trim","expression","staticRenderFns","components_comment_CommentAction","__webpack_require__","normalizeComponent","ssrContext","CommentList","components","newcom","commentquery","commentlist","showin","extends_default","cq","exist_parent_comment","vuex_esm","can_comment","created","initcommentlist","results","length","changecl","arg","filter","sub_comments","changec2","cid","fn2","addparcom","response","comment_CommentList","staticStyle","background","bordered","item-layout","_l","index","key","avatar","title","addcom","delc","nativeOn","$event","CommentList_Component","CommentList_normalizeComponent","__webpack_exports__"],"mappings":"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","file":"static/js/24.58a11212be676ad84c54.js","sourcesContent":["<template>\n  <div class=\"commentaction\">\n    <div class=\"infoAndaction\">\n      <Row>\n        <div class=\"trd\">\n          <Col :xs=\"14\" :sm=\"10\" :md=\"7\">\n            <span v-if=\"i\">\n        {{i.create_time}}\n        </span>\n            <span v-if=\"item\">\n        {{item.create_time}}\n         </span>\n          </Col>\n          <Col :xs=\"5\" :sm=\"4\" :md=\"3\">\n                  <span class=\"r\">\n        <Button type=\"text\" ghost @click=\"reply\" size=\"small\">回复</Button>\n        </span>\n          </Col>\n          <Col :xs=\"5\" :sm=\"4\" :md=\"3\">\n        <span v-if=\"ifcandel\" class=\"d\">\n        <Button type=\"text\" ghost @click=\"deletec\" size=\"small\">删除</Button>\n         </span>\n          </Col>\n        </div>\n\n      </Row>\n      <Row v-if=\"f\">\n        <Input v-model.trim=\"cv\" type=\"textarea\" :autosize=\"true\" :maxlength=\"240\" clearable placeholder=\">__<...\"/>\n        <div class=\"confb\">\n          <Button @click=\"canc\">取消</Button>\n          <Button @click=\"postcommentdata\" type=\"success\">回复</Button>\n        </div>\n\n      </Row>\n\n    </div>\n  </div>\n</template>\n\n<script>\n  import {createComment} from '../../api/api'\n  import {deleteComment} from '../../api/api'\n\n  export default {\n    name: \"CommentAction\",\n    props: ['item', 'i'],\n    inject: ['reload'],\n    data() {\n      return {\n        f: false,\n        cv: '',\n        post_id: this.$route.params.id,\n        cuser: this.$store.state.userinfo.username,\n        newaddc: {}\n      }\n    },\n    computed: {\n      //判断是否有删除权限\n      ifcandel() {\n        if (this.i) {\n          if (this.i.author.username == this.cuser) {\n            return true\n          }\n        } else {\n          if (this.item.author.username == this.cuser) {\n            return true\n          }\n        }\n      }\n    },\n    methods: {\n      reply() {\n        this.f = !this.f\n      },\n      canc() {\n        this.f = false\n      },\n      postcommentdata() {\n        if (this.cv) {\n          if (!this.$store.state.userinfo.username) {\n            this.tolog()\n          } else {\n            //   是对父级评论的回复  无reply_to\n            if (this.item) {\n              createComment(\n                {\n                  \"content\": this.cv,\n                  \"post\": this.post_id,\n                  \"reply_to\": null,\n                  \"parent_comment\": this.item.id,\n                }\n              ).then(res => {\n                console.log(res);\n                this.$Message.success('评论添加成功');\n                this.newaddc = res.data;\n                this.$emit('addcom', this.newaddc)\n                this.f = false\n                this.cv = ''\n              }).catch(err => {\n                console.log(err)\n              })\n            } else {\n              // 对子级评论的回复  有 reply_to\n              console.log(this.i)\n              createComment(\n                {\n                  \"content\": this.cv,\n                  \"post\": this.post_id,\n                  \"reply_to\": this.i.id,\n                  \"parent_comment\": this.i.parent_comment\n                }\n              ).then(res => {\n                console.log(res);\n                this.$Message.success('评论添加成功');\n                let ret_to = {}\n                ret_to['author'] = this.i.author\n                ret_to['id'] = this.i.id\n                this.newaddc = res.data;\n                this.newaddc.reply_to = ret_to\n                this.$emit('addcom', this.newaddc);\n                this.f = false\n                this.cv = ''\n              }).catch(err => {\n                this.$Message.error(\"发生了一个错误，将刷新页面\");\n                setTimeout(() => {\n                  this.reload()\n                }, 1000)\n              })\n            }\n          }\n\n        }\n      },\n      deletec() {\n        let t = this.i || this.item;\n        let v = confirm('确认删除？')\n        if (v){\n        deleteComment({id: t.id}).then(res => {\n          // console.log(res);\n          // console.log(this.i,'i');\n          // console.log(this.item,'item');\n          this.$Message.success('评论删除成功');\n          //  三元表达式的应用\n          const pid = this.i ? this.i.parent_comment : this.item.parent_comment;\n          this.$emit('delc', t.id, parseInt(pid))\n        }).catch(err => {\n          this.$Message.error(\"发生了一个错误，将刷新页面\");\n          setTimeout(() => {\n            this.reload()\n          }, 1000)\n        })\n        }\n\n      },\n      tolog() {\n        this.$Message.error('评论请先登录');\n        setTimeout(() => {\n          this.$router.push({name: 'Login', query: {backurl: 'post/' + this.$route.params.id}})\n        }, 1000)\n      }\n    }\n  }\n</script>\n\n<style scoped lang=\"scss\">\n  .infoAndaction {\n    margin-left: 56px;\n    margin-bottom: 5px;\n\n    span {\n      margin-right: 20px;\n    }\n  }\n\n  .extracomment .infoAndaction {\n    margin-left: 48px;\n    font-size: 1rem;\n  }\n\n  .r .ivu-btn-text:hover {\n    color: rebeccapurple;\n  }\n\n  .d .ivu-btn-text:hover {\n    color: hotpink;\n  }\n\n  .confb {\n    text-align: right;\n    margin-top: 5px;\n  }\n\n  .trd {\n    height: 25px;\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/comment/CommentAction.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"commentaction\"},[_c('div',{staticClass:\"infoAndaction\"},[_c('Row',[_c('div',{staticClass:\"trd\"},[_c('Col',{attrs:{\"xs\":14,\"sm\":10,\"md\":7}},[(_vm.i)?_c('span',[_vm._v(\"\\n      \"+_vm._s(_vm.i.create_time)+\"\\n      \")]):_vm._e(),_vm._v(\" \"),(_vm.item)?_c('span',[_vm._v(\"\\n      \"+_vm._s(_vm.item.create_time)+\"\\n       \")]):_vm._e()]),_vm._v(\" \"),_c('Col',{attrs:{\"xs\":5,\"sm\":4,\"md\":3}},[_c('span',{staticClass:\"r\"},[_c('Button',{attrs:{\"type\":\"text\",\"ghost\":\"\",\"size\":\"small\"},on:{\"click\":_vm.reply}},[_vm._v(\"回复\")])],1)]),_vm._v(\" \"),_c('Col',{attrs:{\"xs\":5,\"sm\":4,\"md\":3}},[(_vm.ifcandel)?_c('span',{staticClass:\"d\"},[_c('Button',{attrs:{\"type\":\"text\",\"ghost\":\"\",\"size\":\"small\"},on:{\"click\":_vm.deletec}},[_vm._v(\"删除\")])],1):_vm._e()])],1)]),_vm._v(\" \"),(_vm.f)?_c('Row',[_c('Input',{attrs:{\"type\":\"textarea\",\"autosize\":true,\"maxlength\":240,\"clearable\":\"\",\"placeholder\":\">__<...\"},model:{value:(_vm.cv),callback:function ($$v) {_vm.cv=(typeof $$v === 'string'? $$v.trim(): $$v)},expression:\"cv\"}}),_vm._v(\" \"),_c('div',{staticClass:\"confb\"},[_c('Button',{on:{\"click\":_vm.canc}},[_vm._v(\"取消\")]),_vm._v(\" \"),_c('Button',{attrs:{\"type\":\"success\"},on:{\"click\":_vm.postcommentdata}},[_vm._v(\"回复\")])],1)],1):_vm._e()],1)])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-70a3ace7\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/components/comment/CommentAction.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-70a3ace7\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./CommentAction.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./CommentAction.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./CommentAction.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-70a3ace7\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./CommentAction.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-70a3ace7\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/comment/CommentAction.vue\n// module id = null\n// module chunks = ","<template>\n  <div id=\"commentlist\">\n    <Card :bordered=\"true\" style=\"background: #fbfbfb\">\n      <div v-if=\"can_comment\">\n        <div class=\"commentlist\">\n          <List item-layout=\"vertical\">\n\n            <ListItem v-for=\"item,index in commentlist\" :key=\"item.id\">\n              <div class=\"maincomment\">\n                <ListItemMeta\n                  :avatar=\"item.author.avatar\"\n                  :title=\"item.author.username+' ： '+item.content\"/>\n                <CommentAction :item=\"item\" @addcom=\"changecl\" @delc=\"changec2\"></CommentAction>\n              </div>\n\n              <div class=\"extracomment\" v-if=\"item.sub_comments\">\n\n                <List item-layout=\"vertical\" v-for=\"i in item.sub_comments\" :key=\"i.id\">\n                  <ListItemMeta v-if=\"i.reply_to\"\n                                :avatar=\"i.author.avatar\"\n                                :title=\"i.author.username+'：@'+i.reply_to.author.username+'：'+i.content\"/>\n                  <ListItemMeta v-else\n                                :avatar=\"i.author.avatar\"\n                                :title=\"i.author.username+'：'+i.content\"/>\n                  <CommentAction :i=\"i\" @addcom=\"changecl\" @delc=\"changec2\"></CommentAction>\n\n                </List>\n              </div>\n\n            </ListItem>\n\n          </List>\n        </div>\n        <div class=\"addcomment\">\n          <template v-if=\"!commentlist.length&&!showin\">\n            <Alert @click.native=\"fn2\">暂无评论呢，添加一条评论吧→_→\n            </Alert>\n          </template>\n          <template v-if=\"showin\">\n            <Input v-model.trim=\"newcom\" type=\"textarea\" :autosize=\"true\" :maxlength=\"240\" clearable\n                   placeholder=\">__<...\"/>\n            <div class=\"confb\">\n              <Button @click=\"canc\">取消</Button>\n              <Button @click=\"addparcom\" type=\"success\">回复</Button>\n            </div>\n          </template>\n        </div>\n      </div>\n      <div v-else>\n        <Alert @click.native=\"fn2\">关闭评论←_←</Alert>\n      </div>\n\n    </Card>\n  </div>\n</template>\n\n<script>\n  import CommentAction from './CommentAction'\n  import {getComment} from '../../api/api'\n  import {createComment} from '../../api/api'\n  import {mapState} from 'vuex'\n\n  export default {\n    name: \"CommentList\",\n    components: {\n      CommentAction\n    },\n    // props: ['can_comment',],\n    data() {\n      return {\n        newcom: '',\n        post_id: this.$route.params.id,\n        commentquery: {},\n        commentlist: [],\n        showin: false\n      }\n    },\n    computed: {\n      cq() {\n        let post_id = this.$route.params.id;\n        this.commentquery = {exist_parent_comment: 2, post: post_id}\n        return this.commentquery\n      },\n      ...mapState({\n        can_comment: 'can_comment'\n      })\n    },\n    created() {\n      // 这里有一个bug暂时无法解决，插眼以后解决\n      // console.log(this.can_comment);\n      this.initcommentlist()\n    },\n    methods: {\n      initcommentlist() {\n        getComment(this.cq).then(res => {\n          this.commentlist = res.data.results;\n          if (this.commentlist.length) {\n            this.showin = true\n          }\n        }).catch(err => {\n          // console.log(err)\n        })\n      },\n      //添加评论\n      changecl(arg) {\n        // console.log(arg, 'arg');\n        //获得评论的父评论\n        let x = this.commentlist.filter(item => {\n          return item.id == arg.parent_comment\n        });\n        // console.log(x[0])\n        x[0].sub_comments.push(arg);\n        // console.log(this.commentlist)\n      },\n      //删除评论\n      changec2(cid, pid) {\n        // console.log(cid, pid);\n        //pid  父评论id  cid 删除的评论的id\n        if (pid) {\n          // 删除子评论\n          let res = this.commentlist.filter(item => {\n            return item.id == pid\n          });\n          //删除回复此评论的其他评论(不好用暂时不用)\n          // res[0].sub_comments = res[0].sub_comments.filter(i => {\n          //   return i.reply_to.id != cid\n          // });\n          res[0].sub_comments = res[0].sub_comments.filter(i => {\n            return i.id != cid\n          })\n\n        } else {\n          // 删除父评论\n          this.commentlist = this.commentlist.filter(item => {\n            return item.id != cid\n          })\n        }\n      },\n      fn2() {\n        this.showin = true\n      }\n      ,\n      canc() {\n        this.newcom = ''\n      }\n      ,\n      //添加父级评论\n      addparcom() {\n        if (this.newcom) {\n          if (!this.$store.state.userinfo.username) {\n            this.tolog()\n          } else {\n            createComment(\n              {\n                \"content\": this.newcom,\n                \"post\": this.post_id,\n                \"reply_to\": null,\n                \"parent_comment\": null,\n              }\n            ).then(res => {\n              console.log(res);\n              this.$Message.success('评论添加成功');\n              this.commentlist.push(res.data)\n              this.newcom = ''\n            }).catch(err => {\n              console.log(err.response)\n            })\n          }\n\n        }\n      },\n      tolog() {\n        this.$Message.error('评论请先登录');\n        setTimeout(() => {\n          this.$router.push({name: 'Login', query: {backurl: 'post/' + this.$route.params.id}})\n        }, 1000)\n      }\n    }\n  }\n</script>\n\n<style scoped lang=\"scss\">\n  #commentlist {\n  }\n\n  /*以下是恢复列表框内容的定制*/\n  /*额外操作行（extra）*/\n  .ivu-list-vertical .ivu-list-item-extra li {\n    display: inline-block;\n    margin-top: 20px;\n    margin-right: 20px;\n  }\n\n  /*头像*/\n  /deep/ .ivu-avatar {\n    width: 40px;\n    height: 40px;\n    line-height: 40px;\n    border-radius: 20px;\n  }\n\n  /deep/ .extracomment .ivu-avatar {\n    width: 32px;\n    height: 32px;\n    line-height: 32px;\n    border-radius: 16px;\n  }\n\n  /deep/ .ivu-list-vertical .ivu-list-item-meta-title {\n    /*padding-right: 100px;*/\n  }\n\n  /* 主回复操作行*/\n  .maincomment .ivu-list-item-action {\n    margin-top: 0;\n    margin-left: 56px;\n  }\n\n  /*item-meta外边距*/\n  .ivu-list-vertical .ivu-list-item-meta {\n    margin-bottom: 0;\n  }\n\n  /deep/ .ivu-list-item-action > li .ivu-icon {\n    /*margin-right: 3px;*/\n  }\n\n  /*  子评论*/\n  .extracomment {\n    margin-left: 15px;\n    padding-left: 25px;\n    border-left: 2px solid #8a8a8a;\n    background: #F6F8FA;\n\n    /deep/ .ivu-list-item-meta-title {\n      font-weight: 400;\n    }\n  }\n\n  /deep/ .ivu-btn-ghost {\n    color: #F6F8FA\n  }\n\n  .confb {\n    text-align: right;\n    margin-top: 5px;\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/comment/CommentList.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"commentlist\"}},[_c('Card',{staticStyle:{\"background\":\"#fbfbfb\"},attrs:{\"bordered\":true}},[(_vm.can_comment)?_c('div',[_c('div',{staticClass:\"commentlist\"},[_c('List',{attrs:{\"item-layout\":\"vertical\"}},_vm._l((_vm.commentlist),function(item,index){return _c('ListItem',{key:item.id},[_c('div',{staticClass:\"maincomment\"},[_c('ListItemMeta',{attrs:{\"avatar\":item.author.avatar,\"title\":item.author.username+' ： '+item.content}}),_vm._v(\" \"),_c('CommentAction',{attrs:{\"item\":item},on:{\"addcom\":_vm.changecl,\"delc\":_vm.changec2}})],1),_vm._v(\" \"),(item.sub_comments)?_c('div',{staticClass:\"extracomment\"},_vm._l((item.sub_comments),function(i){return _c('List',{key:i.id,attrs:{\"item-layout\":\"vertical\"}},[(i.reply_to)?_c('ListItemMeta',{attrs:{\"avatar\":i.author.avatar,\"title\":i.author.username+'：@'+i.reply_to.author.username+'：'+i.content}}):_c('ListItemMeta',{attrs:{\"avatar\":i.author.avatar,\"title\":i.author.username+'：'+i.content}}),_vm._v(\" \"),_c('CommentAction',{attrs:{\"i\":i},on:{\"addcom\":_vm.changecl,\"delc\":_vm.changec2}})],1)}),1):_vm._e()])}),1)],1),_vm._v(\" \"),_c('div',{staticClass:\"addcomment\"},[(!_vm.commentlist.length&&!_vm.showin)?[_c('Alert',{nativeOn:{\"click\":function($event){return _vm.fn2($event)}}},[_vm._v(\"暂无评论呢，添加一条评论吧→_→\\n          \")])]:_vm._e(),_vm._v(\" \"),(_vm.showin)?[_c('Input',{attrs:{\"type\":\"textarea\",\"autosize\":true,\"maxlength\":240,\"clearable\":\"\",\"placeholder\":\">__<...\"},model:{value:(_vm.newcom),callback:function ($$v) {_vm.newcom=(typeof $$v === 'string'? $$v.trim(): $$v)},expression:\"newcom\"}}),_vm._v(\" \"),_c('div',{staticClass:\"confb\"},[_c('Button',{on:{\"click\":_vm.canc}},[_vm._v(\"取消\")]),_vm._v(\" \"),_c('Button',{attrs:{\"type\":\"success\"},on:{\"click\":_vm.addparcom}},[_vm._v(\"回复\")])],1)]:_vm._e()],2)]):_c('div',[_c('Alert',{nativeOn:{\"click\":function($event){return _vm.fn2($event)}}},[_vm._v(\"关闭评论←_←\")])],1)])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-5e1e8f5c\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/components/comment/CommentList.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-5e1e8f5c\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./CommentList.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./CommentList.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./CommentList.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-5e1e8f5c\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./CommentList.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-5e1e8f5c\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/comment/CommentList.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}