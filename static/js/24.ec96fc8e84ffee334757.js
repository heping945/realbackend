webpackJsonp([24],{V6QF:function(t,e){},d2IK:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=r("P9l9"),i={name:"SubjectManage",data:function(){return{header:{},subjectlist:[],topicselect:"",summary:[],modal1:!1,value:"",chaptertitle:"",chapterorder:null,chapterid:null}},computed:{url:function(){return"https://zhaoheping.com/api/v1/chapters/"},h:function(){var t=this.$store.state.userinfo.token;if(t)return this.header.Authorization="JWT "+t,this.header},uploaddata:function(){var t={};return t.topic=this.topicselect,t}},created:function(){this.initsubjectlist()},methods:{initsubjectlist:function(){var t=this;Object(a.t)().then(function(e){t.subjectlist=e.data.results}).catch(function(t){})},getsubjectsummary:function(t){var e=this;Object(a.n)({topic:t}).then(function(t){e.summary=t.data.results}).catch(function(t){})},updatechapter:function(t){this.chaptertitle=t.title,this.chapterorder=t.order,this.chapterid=t.id,this.modal1=!0},ok:function(){var t=this;this.chaptertitle&&this.chapterorder?Object(a.D)({id:this.chapterid,title:this.chaptertitle,order:this.chapterorder}).then(function(e){t.summary=t.summary.filter(function(e){return e.id!=t.chapterid});var r=t.summary.filter(function(t){return t.order==e.data.order});if(r.length){var a=r[0],i=t.summary.indexOf(a);t.summary.splice(i,0,e.data),t.$Message.success("更新成功")}else{var s=t.summary.indexOf(t.summary.filter(function(t){return t.order>e.data.order})[0]);-1!=s?t.summary.splice(s,0,e.data):t.summary.push(e.data),t.$Message.success("更新成功")}}).catch(function(e){t.$Message.error("输入错误，请检查输入类型（order只能为正整数）")}):this.$Message.warning("无效输入，请检查")},cancel:function(){},getmd:function(t,e,r){this.summary.filter(function(e){return e.id==t.id}).length?this.$Notice.warning({title:"请勿重复上传",duration:1}):(this.$Notice.success({title:"上传成功",duration:1}),this.summary.push(t))},prerr:function(t,e,r){this.$Message.error(e.detail)},validatetopic:function(){if(!this.topicselect)return this.$Message.warning("请选择一个专题"),!1;var t=this.$store.state.userinfo.username;return"heping"!=t?(this.$Message.error("您没有权限!!!请联系管理员开通权限"),!1):void 0}}},s={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"commonpositiontop p-container",staticStyle:{"z-index":"199"}},[r("Row",[r("Col",{attrs:{xs:24,sm:24,md:0,lg:0}},[r("div",{staticStyle:{"text-align":"center",padding:"100px 100px"}},[r("h3",{staticStyle:{"font-size":"2rem",color:"rebeccapurple"}},[t._v("此设备不支持编辑文章请更换大设备")])])]),t._v(" "),r("Col",{attrs:{xs:0,sm:0,md:24,lg:24}},[r("Select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择专题标题"},on:{"on-change":t.getsubjectsummary},model:{value:t.topicselect,callback:function(e){t.topicselect=e},expression:"topicselect"}},t._l(t.subjectlist,function(e){return r("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.title))])}),1),t._v(" "),t.summary.length?r("Alert",{staticStyle:{"margin-top":"20px"},attrs:{type:"success"}},[r("List",t._l(t.summary,function(e,a){return r("ListItem",{key:e.id,nativeOn:{click:function(r){return t.updatechapter(e)}}},[r("b",[t._v(t._s(a+1))]),t._v("：  "),r("b",{staticStyle:{color:"#007fff"}},[t._v(t._s(e.order))]),t._v("：  "),r("b",{staticStyle:{color:"rebeccapurple"}},[t._v(t._s(e.id))]),t._v("：  "+t._s(e.title)+"\n          ")])}),1)],1):t._e(),t._v(" "),r("Alert",{staticStyle:{"margin-top":"20px"},attrs:{type:"warning"}},[t._v("权限，顺序控制请联系管理")]),t._v(" "),r("Upload",{attrs:{action:t.url,format:["md"],data:t.uploaddata,name:"md_File",paste:!0,multiple:!0,accept:".md","on-success":t.getmd,"on-error":t.prerr,headers:t.h,"before-upload":t.validatetopic}},[r("div",{staticStyle:{padding:"10px 0"}},[r("Button",{staticStyle:{margin:"0 auto"},attrs:{icon:"ios-cloud-upload-outline",title:"只能选择md格式文件，可以多选",long:""}},[t._v("上传md文件")])],1)])],1)],1),t._v(" "),r("Modal",{attrs:{title:"请输入更改信息","ok-text":"更新"},on:{"on-ok":t.ok,"on-cancel":t.cancel},model:{value:t.modal1,callback:function(e){t.modal1=e},expression:"modal1"}},[r("Form",{attrs:{"label-width":50}},[r("FormItem",{attrs:{label:"标题"}},[r("Input",{attrs:{placeholder:"Enter title...",maxlength:64},model:{value:t.chaptertitle,callback:function(e){t.chaptertitle="string"==typeof e?e.trim():e},expression:"chaptertitle"}})],1),t._v(" "),r("FormItem",{attrs:{label:"顺序"}},[r("InputNumber",{staticStyle:{width:"100%"},attrs:{max:200,min:0,placeholder:"Enter order..."},model:{value:t.chapterorder,callback:function(e){t.chapterorder=e},expression:"chapterorder"}})],1)],1)],1)],1)},staticRenderFns:[]};var n=r("C7Lr")(i,s,!1,function(t){r("V6QF")},"data-v-19eb8db2",null);e.default=n.exports}});